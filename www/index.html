<!DOCTYPE html> 
<html>
  <head>
	<title>Control</title>

    <meta name="viewport" content="width=320; user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />	
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
	
	<link rel="stylesheet" href="css/jquery.mobile-1.0a3.css" />
    <link rel="stylesheet" href="css/master.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<!--<link rel="stylesheet" href="css/iscroll.css" type="text/css" media="screen" charset="utf-8">-->

	
    <script type="text/javascript" charset="utf-8" src="js/phonegap-uncompressed.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/NativeControls.js"></script>
	
	<!-- jQuery -->
	<script src="js/jquery-1.5.js"></script>
	<script src="js/jquery.mobile-1.0a3.js"></script>

	
	<!-- iScroll: scrolling table views for webkit interface: http://cubiq.org/iscroll -->
	<!--<script type="text/javascript" src="js/iscroll.js"></script>-->
	
	<!-- Lawnchair. used to persistently store json files. http://brianleroux.github.com/lawnchair/ -->
	<script type="text/javascript" src="lawnchair/src/Lawnchair.js"></script>  
	<script type="text/javascript" src="lawnchair/src/adaptors/LawnchairAdaptorHelpers.js"></script>  		
	<script type="text/javascript" src="lawnchair/src/adaptors/WebkitSQLiteAdaptor.js"></script>  	

    <!-- Font support for iPhone canvas. For more fonts go here: http://typeface.neocracy.org/fonts.html 
    Google code project: http://code.google.com/p/canvas-text/ 
    <script type="text/javascript" src="canvas.text.js?reimplement=true"></script>
    <script type="text/javascript" src="faces/helvetiker_regular.typeface.js"></script>-->
	
	<script type="text/javascript" src="js/Control.js"></script>
	<script type="text/javascript" src="js/InterfaceManager.js"></script>
	<script type="text/javascript" src="js/DestinationManager.js"></script>
	<script type="text/javascript" src="js/PreferencesManager.js"></script>
	<script type="text/javascript" src="js/OSCManager.js"></script>		
	<script type="text/javascript" src="js/MIDIManager.js"></script>		
	
    <script type="text/javascript" src="js/Widget.js"></script>
    <script type="text/javascript" src="js/Slider.js"></script>
    <script type="text/javascript" src="js/MultiSlider.js"></script>	
	<script type="text/javascript" src="js/Knob.js"></script>
	<script type="text/javascript" src="js/MultiTouchXY.js"></script>
    <script type="text/javascript" src="js/Button.js"></script>
    <script type="text/javascript" src="js/MultiButton.js"></script>	
    <script type="text/javascript" src="js/Label.js"></script>
	<script type="text/javascript" src="js/ControlAccelerometer.js"></script>
	<script type="text/javascript" src="js/ControlCompass.js"></script>
	<script type="text/javascript" src="js/ControlGyro.js"></script>
    
        
    <!--<script type="text/javascript" src="../../interfaces/test.js"></script>-->
        
    <script type="text/javascript" charset="utf-8">
		var pages, control, interfaceScroller, destinationScroller, interfaceManager, destinationManager, _protocol;
		function preventBehavior(e) { // prevent scrolling
			e.preventDefault(); 
		};
        
		console.log("something");
		PhoneGap.addConstructor(function(){
			document.addEventListener("touchmove", preventBehavior, false); // prevents webkit from scrolling DNR
            //console.log("interface name = *******" + window.loadedInterfaceName);
            // console.log("window.TEST.pages = " + window.TEST.pages);

            control = new Control();

            _protocol = "OSC";
			//console.setLevel(8);
			oscManager = new OSCManager();
			midiManager = new MIDIManager();
			
			destinationManager = new DestinationManager();
			destinationManager.init();

			interfaceManager = new InterfaceManager();
			interfaceManager.init();
            interfaceManager.loadScripts();

			document.addEventListener('orientationChanged', control.onRotation, false);
			
			//interfaceScroller   = new iScroll('interfaceScroller');
			//destinationScroller = new iScroll('destinationScroller');
			//preferencesScroller = new iScroll('preferencesScroller');
			
			PhoneGap.exec("Device.setRotation", "portrait");
			
			preferencesManager = new PreferencesManager();
			console.log("end of constructor");
		});
		
		function autolockToggle() {
			var autolockToggleLink = document.getElementById("autolockToggle");
			autolock = !autolock;
			(!autolock) ? autolockToggleLink.innerHTML = "Turn Autolock <b>Off</b>" : autolockToggleLink.innerHTML = "Turn Autolock <b>On</b>";			
			PhoneGap.exec("Device.autolockToggle", autolock);
			preferences.save({key:"autolock", shouldAutolock:autolock});
		}

    </script>
  </head>
  
  <body id="stage" style="background-color:#000; -webkit-user-select: none;"  onload="document.addEventListener('touchmove', preventBehavior, false);" class="theme"> 
  

  <div data-role="page" id="Interfaces" data-theme="a">
		<div class="ui-bar-a  ui-header " data-role="header" id="header" data-backbtn="false">
			<a href="#" id="interfaceEditBtn" style="padding-top:.5em; width:4em; height:1.75em;" class="ui-btn-left ui-btn ui-btn-corner-all ui-btn-up-a" ontouchend="interfaceManager.editInterfaceList()">Edit</a>
			<h1 class="ui-title">Interfaces</h1>
			<a href="#" style="padding-top:.5em; width:4em; height:1.75em;" class="ui-btn-right ui-btn ui-btn-corner-all ui-btn-up-a" ontouchend="interfaceManager.promptForInterfaceDownload()">+</a>
		</div>
		
		<div data-role="content">
			<ul id="interfaceList" data-role="listview" data-theme="g"></ul>
		</div>
	</div>
  
  <div data-role="page" id="Destinations" data-theme="a">
		<div data-role="header" id="header" data-backbtn="false">
			<a href="#" id="destinationsEditBtn"style="padding-top:.5em; width:4em; height:1.75em;" class="ui-btn-left ui-btn ui-btn-corner-all ui-btn-up-a" ontouchend="destinationManager.editDestinationList()">Edit</a>		
			<h1>Destinations</h1>
			<a href="#" style="padding-top:.5em; width:4em; height:1.75em;" class="ui-btn-right ui-btn ui-btn-corner-all ui-btn-up-a" ontouchend="destinationManager.promptForIP()">+</a>
		</div>
		<div data-role="content">
            <ul id="destinationList" data-role="listview" data-theme="g"></ul>
		</div>
  </div>
  
  <div data-role="page" id="Preferences" data-theme="a">
	<div data-role="header" id="header" data-backbtn="false"><h1>Preferences</h1></div>
	<div data-role="content">
        <ul id="preferencesList" data-role="listview" data-theme="g">
            <li class="preferencesListItem"><a id="autolockToggle" href="#" ontouchend="preferencesManager.autolockToggle()">Turn Autolock <b>On</b></a></li>
            <li class="preferencesListItem">OSC Receive Port : 
                <form id="oscForm" style="display:inline;" onsubmit="console.log('NEORIB');portField.blur(); preferencesManager.changePort(portField.value);">
                    <input style="display:inline; width:150px;" type="number" id="receivePortSelector" name="portField" value="8080" onchange="">
                </form>
            </li>
        </ul>
	</div>
  </div>
  
  <div data-role="page" id="Info" data-theme="a">
	<div data-role="header" id="header" data-backbtn="false">
		<h1>Info</h1>
	</div>
	
	<div data-role="content">
	    <p>Control v1.2 is an application enabling configurable control surfaces for mobile devices. For more information, interfaces, tutorials and references please visit
    	<a href="http://www.charlie-roberts.com/Control">the Control website</a>.
    	</p>
    	<p>
    	Control was created and is maintained by <a href="http://www.charlie-roberts.com">Charlie Roberts</a>, with additional contributions by <a href="www.thepersistentbeat.com">Greg Shear</a> 
    	and <a href="http://www.create.ucsb.edu/~matt/">Matt Wright</a>. Control was partially realized as a research project for the <a href="http://allosphere.ucsb.edu">AlloSphere Research Group</a>.
    	</p>

    	<p>Control is built using the following open source projects (thank you!):</p>
    	<ul>
    		<li><a href="http://www.phonegap.com">PhoneGap</a> - an API for developing cross-platform mobile applications</li>
    		<li><a href="http://cubiq.org/iscroll">iScroll</a> - scrolling table views for WebKit interfaces</li>
    		<li><a href="http://brianleroux.github.com/lawnchair/">Lawnchair</a> - cross-platform persistent storage of JSON information</li>
    		<li><a href="http://www.audiomulch.com/~rossb/code/oscpack/">oscpack</a> - cross-platform OSC library.
    	</ul>
	</div>
  </div>
  
   <div data-role="page" id="SelectedInterfacePage">
	   <div class="ui-bar-a ui-header" data-role="header" id="header" data-backbtn="false"></div>
	   <div data-role="content" id="selectedInterface"></div>
  </div>

  <!--<div style="display:block; position:fixed; top: 100px; left: 100px; width:50px; height:50px; background-color:#f00; z-index:100;" ontouchend="window.location.reload(true)"><h2>RELOAD</h2></div>-->
      
  <div data-role="footer" data-id="foo1" data-position="fixed" class="ftr ui-bar-a ui-footer ui-footer-fixed ui-fixed-overlay" role="contentinfo" style=" border-top-width:0;bottom:0px">
      <div data-role="navbar" class="ui-navbar ui-navbar-noicons" role="navigation">
          <ul class="ui-navbar-noicons ui-grid-c"  style="border-top-width:0;">
              <li class="ui-block-a" style=" border-top-width:0;"><a href="#Interfaces" class="ui-btn ui-btn-up-a" style=" border-top-width:0;" data-theme="a"><span class="ui-btn-inner"><span class="ui-btn-text" style="font-size:1em">Interfaces</span></span></a></li>
              <li class="ui-block-b"><a href="#Destinations" data-theme="a" class="ui-btn ui-btn-up-a">
                  <span class="ui-btn-inner" style="padding-left:0; padding-right:0;"><span class="ui-btn-text" >Destinations</span></span></a></li>
              <li class="ui-block-b"><a href="#Preferences" data-theme="a" class="ui-btn ui-btn-up-a"><span class="ui-btn-inner" style="padding-left:0; padding-right:0;"><span class="ui-btn-text">Preferences</span></span></a></li>
              <li class="ui-block-b"><a href="#Info" data-theme="a" class="ui-btn ui-btn-up-a"><span class="ui-btn-inner"><span class="ui-btn-text">Info</span></span></a></li>

          </ul>
      </div>
  </div>
  </body>
</html>
